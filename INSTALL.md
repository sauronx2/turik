# 📦 Встановлення Desktop додатку

## ❗ Що сталося (помилка)

Помилка **"spawn node ENOENT"** виникла тому що Electron не міг знайти Node.js для запуску backend серверу.

**Виправлено!** Тепер backend запускається напряму через Electron's Node.js.

---

## 📁 Де знаходяться білди?

Всі зібрані додатки в теці:

```
/Users/serhadov/turik/dist-electron/
```

---

## 🎯 Яку версію брати для Mac M3?

### ✅ ДЛЯ ТВОГО M3 PRO:

```
Турнір-1.0.0-Mac-arm64.dmg
```

**arm64** = Apple Silicon (M1/M2/M3/M4)

### Інші версії:

```
Турнір-1.0.0-Mac-x64.dmg
```

**x64** = Intel Mac (старі MacBook)

---

## 🚀 Правильна установка

### Крок 1: Видали стару версію (якщо встановлював)

```bash
# Відкрий Finder → Applications
# Знайди "Турнір.app"
# Перетягни в корзину

# АБО з терміналу:
rm -rf /Applications/Турнір.app
```

### Крок 2: Відкрий правильний DMG

```bash
# Відкрий DMG для M3
open dist-electron/Турнір-1.0.0-Mac-arm64.dmg
```

### Крок 3: Перетягни в Applications

1. З'явиться вікно з іконкою "Турнір.app"
2. **Перетягни** іконку в теку **"Applications"** (буде стрілка)
3. Дочекайся копіювання
4. Закрий вікно DMG

### Крок 4: Запусти

```bash
# Варіант 1: З терміналу
open /Applications/Турнір.app

# Варіант 2: Через Spotlight
# Cmd + Space → набери "Турнір" → Enter

# Варіант 3: З Launchpad
# F4 або жест → знайди "Турнір" → клік
```

---

## 🔒 Якщо macOS блокує

При першому запуску може з'явитись:

```
"Турнір" can't be opened because it is from an unidentified developer
```

### Варіант 1: Через System Settings

1. Відкрий **System Settings** (⚙️)
2. **Privacy & Security**
3. Прокрути вниз, побачиш:
   ```
   "Турнір" was blocked from use
   ```
4. Натисни **"Open Anyway"**
5. Підтверди пароль
6. Натисни **"Open"** ще раз

### Варіант 2: Через контекстне меню

1. Відкрий **Finder** → **Applications**
2. Знайди **Турнір.app**
3. **Правою кнопкою** → **Open**
4. Підтверди **"Open"**

### Варіант 3: Через термінал

```bash
# Видали quarantine атрибут
sudo xattr -rd com.apple.quarantine /Applications/Турнір.app

# Потім просто відкрий
open /Applications/Турнір.app
```

---

## ✅ Перевірка що працює

### Після запуску має бути:

1. ✅ **Вікно турніру** відкривається
2. ✅ **Іконка 🏆 в tray bar** (верхня панель праворуч)
3. ✅ **В консолі** (якщо запускав з терміналу):
   ```
   🚀 Starting backend server...
   ✅ Backend server loaded via require
   Server running on http://localhost:3000

   📡 Адреса для підключення: http://192.168.31.172:5173
   ```

### Перевірка IP адреси:

1. **Клікни правою** на іконку 🏆 в tray bar
2. Побачиш меню:
   ```
   🏆 Турнір
   ━━━━━━━━━━━━━━━━
   📡 Адреса для підключення
      http://192.168.31.172:5173  ← ТВОЯ IP
      Копіювати адресу
   ━━━━━━━━━━━━━━━━
   🪟 Показати вікно
   🌐 Відкрити в браузері
   ━━━━━━━━━━━━━━━━
   🚪 Вийти
   ```

---

## 📁 Структура білдів

```
dist-electron/
├── Турнір-1.0.0-Mac-arm64.dmg          ← ДЛЯ M1/M2/M3/M4
├── Турнір-1.0.0-Mac-arm64.dmg.blockmap
├── Турнір-1.0.0-Mac-x64.dmg            ← ДЛЯ INTEL MAC
├── Турнір-1.0.0-Mac-x64.dmg.blockmap
├── mac/                                 (тека з розпакованою x64 версією)
└── mac-arm64/                           (тека з розпакованою arm64 версією)
```

### Розміри:

- **arm64.dmg**: ~106-110 MB (compressed)
- **x64.dmg**: ~110-115 MB (compressed)
- **Встановлений додаток**: ~300-400 MB (включає Node.js + Chromium + залежності)

---

## 🐛 Troubleshooting

### Помилка "App is damaged"

```bash
sudo xattr -rd com.apple.quarantine /Applications/Турнір.app
```

### Порт вже зайнятий (3000 або 5173)

```bash
# Знайди та вбий процес
lsof -ti:3000 | xargs kill -9
lsof -ti:5173 | xargs kill -9
```

### Вікно не відкривається

1. Перевір чи є іконка в tray bar
2. Клікни на неї правою → "Показати вікно"
3. Або закрий і запусти заново

### Backend не запускається

Якщо в консолі бачиш помилки:
1. Перевір що `server/index.js` існує
2. Перевір що `node_modules` встановлені
3. Пересобери додаток: `npm run electron:build:mac`

### Повністю видалити додаток

```bash
# Видали додаток
rm -rf /Applications/Турнір.app

# Видали налаштування (опціонально)
rm -rf ~/Library/Application\ Support/Турнір
rm -rf ~/Library/Preferences/com.turik.app.plist
rm -rf ~/Library/Logs/Турнір
```

---

## 🔄 Як пересобрати після змін

Якщо змінював код і хочеш пересобрати:

```bash
# 1. Збудуй клієнт
cd client && npm run build && cd ..

# 2. Збудуй додаток
npm run electron:build:mac

# 3. Видали стару версію
rm -rf /Applications/Турнір.app

# 4. Встанови нову
open dist-electron/Турнір-1.0.0-Mac-arm64.dmg
```

---

## 📊 Нейминг білдів

Тепер білди мають зрозумілі назви:

```
${Назва}-${Версія}-Mac-${Архітектура}.${Розширення}

Приклад:
Турнір-1.0.0-Mac-arm64.dmg
│      │      │   │      │
│      │      │   │      └─ Формат (dmg)
│      │      │   └──────── Архітектура (arm64 або x64)
│      │      └──────────── Платформа (Mac)
│      └─────────────────── Версія (1.0.0)
└────────────────────────── Назва додатку
```

**Для твого M3 завжди бери `arm64`!**

---

**Готово! Тепер додаток має працювати без помилок! 🎉**
